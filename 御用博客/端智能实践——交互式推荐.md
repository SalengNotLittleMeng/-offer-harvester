# 端智能技术在美团内部的实践

端智能，与云智能相对应。顾名思义，就是将一部分人工智能的内容，下放到客户端去做，确切地说，端智能会将特征（埋点 SQL），算子（数据计算的能力），模型（提前训练好的离线数据模型）下发到端。在很多人眼中，跟前端的落地实践还比较遥远，其实在很多大厂中已经将这种技术进行了广泛地运用，我们现在看到的很多产品（尤其是社区类产品）都有端智能的影子

目前国内端智能领域做的最好是阿里巴巴，旗下的开源端智能项目 MNN 基本可以实现配置化的端智能。同时，美团，字节内部也都对 MNN 进行了个性化的定制，搭建出自己的端智能引擎

## 端智能的优势

相比于传统的云智能（将人工智能的部分放到后端进行），端智能拥有以下这些优势：

- 更快速，计算完全在客户端进行，不必多次向后端请求数据，计算完全是即时的，因此速度更快。这种优势在需要对用户的频繁操作做出智能响应的场景下会显得更加重要
- 更安全，将用户的各种数据保存在客户端，无需上传到服务器进行计算，避免了服务器数据泄露或者请求被抓包的安全隐患。安全性更好。
- 更个性化，端智能完全基于用户每个人的数据生产模型和计算推到，而不会像云智能那样通过大数据进行规律分析，能真正做到个性化推荐和“千人千面”
- 数据的利用率高，端智能可以跟埋点系统进行整合，直接复用用户的行为数据和应用的运行数据，不必添加多余的逻辑和数据

### 端智能的基本架构

- 引擎层：美团的端智能引擎 MTNN 基于阿里的 MNN，根据内部业务做了进一步的定制

- 交互层：跟用户的直接交互的部分，根据端智能响应的数据做出视图上的交互，比如展示卡片；对列表的动态添加，替换，插入，修改顺序；执行浮层等

- 策略层（云端）：向客户端推送模型，参数（特征权重等）并返回一些基本的后端数据，比如天气情况，商家信息等作为端智能的补充数据。同时一些复杂的数据计算也会上传到云端计算。比如精细化分析用户意图。同时，策略层还会负责客户端模型和数据的更新

- 触发层：触发端智能的模块，根据保存在客户端的规则，脚本代码，和模型进行数据分析，当用户达成了某一条件会触发对应钩子，触发交互层的逻辑

- 数据层：对接埋点系统，利用埋点系统收集各种信息，比如停留时间，滑动速度，用户移动，路由顺序等

基于规则引擎（sdk）——》相对于策略脚本和 native 开发可进行可视化配置（设置规则 dsl）

规则引擎：
_ 感知用户行为：单个埋点
_ 感知用户意图：多个埋点以及顺序（描绘用户画像） \* 识别结果，通过客户端或网络请求进行触达用户

相比于云智能，仅需要拉去少部分客户端数据和更新规则信息，可以利用差异缓存（用版本号进行判断）进行差异更新

多平台联动时进行配置校验并对接大象

规则引擎 sdk：通过埋点方案获取行为，通过桥（本地）缓存的数据和请求到的规则不断进行匹配，匹配到对应行为则触发对应的钩子

交互式推荐和问卷调查

智能触达和商家防打扰

埋点，获取成功率，匹配成率，异常上报

应用：智能推荐，触达矩阵，动态话列表，信息重排，智能推荐，预加载，智能运营（红包，折扣，挽留用户）,美颜，图像识别

后台下发服务端数据，模型 参数（特征权重等）即可

列表首次渲染-初始化 sdk——用户交互收集-——端智能推理--利用桥进行数据传输——卡控（保证渲染过的不会被排序）——修改后续列表

通过桥对数据进行对接
